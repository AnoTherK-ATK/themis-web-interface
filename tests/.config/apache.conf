<VirtualHost *:80>
	DocumentRoot %TRAVIS_BUILD_DIR%
	ServerName localhost

	ErrorDocument 400 /lib/error.php
	ErrorDocument 401 /lib/error.php
	ErrorDocument 403 /lib/error.php
	ErrorDocument 404 /lib/error.php
	ErrorDocument 405 /lib/error.php
	ErrorDocument 406 /lib/error.php
	ErrorDocument 408 /lib/error.php
	ErrorDocument 414 /lib/error.php
	ErrorDocument 500 /lib/error.php
	ErrorDocument 502 /lib/error.php

	<Directory "%TRAVIS_BUILD_DIR%/">
		Options FollowSymLinks MultiViews ExecCGI
		AllowOverride All
		Require all granted
	</Directory>

	<Directory "%TRAVIS_BUILD_DIR%/api/">
		Options +FollowSymLinks -Indexes
		Order allow,deny
		Allow from all
		Require all granted

		# Rewrite url
		RewriteEngine on
		RewriteCond %{REQUEST_FILENAME} !-f
		RewriteRule ^([^\.]+)$ $1.php [NC,L]
	</Directory>

	# Wire up Apache to use Travis CI's php-fpm.
	<IfModule mod_fastcgi.c>
		<Directory /usr/lib/cgi-bin>
			Require all granted
		</Directory>

		<IfModule mod_fastcgi.c>
			AddHandler php7.2-fcgi .php
			Action php7.2-fcgi /php7.2-fcgi virtual
			Alias /php7.2-fcgi /usr/lib/cgi-bin/php7.2-fcgi
			FastCgiExternalServer /usr/lib/cgi-bin/php7.2-fcgi -socket /run/php/php7.2-fpm.sock -pass-header Authorization
		</IfModule>
	</IfModule>

	ErrorLog ${APACHE_LOG_DIR}/error.log
	CustomLog ${APACHE_LOG_DIR}/access.log combined
</VirtualHost>