<VirtualHost *:80>
	DocumentRoot %TRAVIS_BUILD_DIR%

	<Directory "%TRAVIS_BUILD_DIR%/">
		Options FollowSymLinks MultiViews ExecCGI
		AllowOverride All
		Require all granted
	</Directory>

	<Directory "%TRAVIS_BUILD_DIR%/api">
		Options +FollowSymLinks -Indexes
		Order allow,deny
		Allow from all
		Require all granted

		# Rewrite url
		RewriteEngine on
		RewriteCond %{REQUEST_FILENAME} !-f
		RewriteRule ^([^\.]+)$ $1.php [NC,L]
	</Directory>

	# Wire up Apache to use Travis CI's php-fpm.
	<IfModule mod_fastcgi.c>
		<FilesMatch \.php$>
			# 2.4.10+ can proxy to unix socket
			SetHandler "proxy:unix:/var/run/php/php7.2-fpm.sock|fcgi://localhost/"

			# Else we can just use a tcp socket:
			#SetHandler "proxy:fcgi://127.0.0.1:9000"
		</FilesMatch>

		<Directory /usr/lib/cgi-bin>
			Require all granted
		</Directory>
	</IfModule>
</VirtualHost>